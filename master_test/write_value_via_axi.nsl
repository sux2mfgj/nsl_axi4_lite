#include "write_value_via_axi.h"

module write_value_via_axi
{
    axi4_lite_master master;
    reg before[2] = 0;
    reg sending = 0;

    // connection for axi master
    awvalid = master.awvalid;
    master.awready = awready;
    awaddr = master.awaddr;
    awprot = master.awprot;
    wvalid = master.wvalid;
    master.wready = wready;
    wdata = master.wdata;
    wstrb = master.wstrb;
    master.bvalid = bvalid;
    bready = master.bready;
    master.bresp = bresp;
    arvalid = master.arvalid;
    master.arready = arready;
    araddr = master.araddr;
    arprot = master.arprot;
    master.rvalid = rvalid;
    rready = master.rready;
    master.rdata = rdata;
    master.rresp = rresp;

    before := sw;
    if(!before[0] && sw[0] && !sending)
    {
        master.write_value(0x40000000, 32'h6);
        sending := 1'b1;
    }
    if(!before[1] && sw[1] && !sending)
    {
        master.write_value(0x40000000, 32'h9);
        sending := 1'b1;
    }

    func master.write_done
    {
        sending := 1'b0;
    }

    func master.write_error
    {
        sending := 1'b0;
    }
}
